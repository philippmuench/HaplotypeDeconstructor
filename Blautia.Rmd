
```{r}
library(HaplotypeDeconstructor)
data(omm4)
```

```{r}
decomposed <- findHaplotypes(omm4, 3)
plotHaplotypeMap(decomposed)
```


```r
# check how many haplotypes are in the community
gof <- assessNumberHaplotyes(omm4, 2:6, nReplicates = 3)
plotNumberHaplotyes(gof)
```

```r
plotSamples(decomposed, normalize = F, percent = T)
```

Now we can better organize the by additional metadata groups

```r
data(omm2_metadata)
plotSamplesByGroup(decomposed, omm2_metadata, normalize = F, percent = T)
```


We can visualize the SNP annotations for each Haplotype

```r
data(omm_snp_annotation)
plotHaplotypeAnnotation(decomposed, omm_snp_annotation, sig_threshold = 0.002)
```


